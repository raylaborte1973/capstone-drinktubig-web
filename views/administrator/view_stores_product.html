<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>DrinkTubig: Mobile Based Water Refilling Stations Ordering and Delivery System</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="assets/images/icon/favicon/favicon.ico">
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/font-awesome.min.css">
    <link rel="stylesheet" href="assets/css/themify-icons.css">
    <link rel="stylesheet" href="assets/css/metisMenu.css">
    <link rel="stylesheet" href="assets/css/owl.carousel.min.css">
    <link rel="stylesheet" href="assets/css/slicknav.min.css">
    <!-- others css -->
    <link rel="stylesheet" href="assets/css/typography.css">
    <link rel="stylesheet" href="assets/css/default-css.css">
    <link rel="stylesheet" href="assets/css/styles.css">
    <link rel="stylesheet" href="assets/css/responsive.css">
    <!-- modernizr css -->
    <script src="assets/js/vendor/modernizr-2.8.3.min.js"></script>
</head>


<body>
    <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
  
    <!-- page container area start -->
    <div class="page-container">
        <!-- sidebar menu area start -->
        <div class="sidebar-menu">
            <div class="sidebar-header ">
                
                    <a href="dashboard.html"><!-- <img src="assets/images/icon/logo.png" alt="logo"> --><h2 style="color:white;text-align:center">DrinkTubig</h2></a>
            </div>
            <div class="main-menu">
                <div class="menu-inner">
                    <nav>
                        <ul class="metismenu" id="menu">
                             <li><a href="dashboard.html"><i class="fa fa-tachometer"></i> <span>Dashboard</span></a></li>
                             <li><a href="view_accounts.html"><i class="fa fa-users"></i> <span>Account</span></a></li>
                             <li class="active"><a href="view_stores.html"><i class="fa fa-building"></i> <span>Stores</span></a></li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
        <!-- sidebar menu area end -->
        <!-- main content area start -->
        <div class="main-content">
            <!-- header area start -->
            <div class="header-area">
                <div class="row align-items-center">
                    <!-- nav and search button -->
                    <div class="col-md-3 col-sm-8 clearfix">
                        <div class="nav-btn pull-left" style="background:none">
                            <span style="background-color:#b3aaaa"></span>
                            <span style="background-color:#b3aaaa"></span>
                            <span style="background-color:#b3aaaa"></span>
                        </div>
                    </div>
                     <div class="col-md-9 col-sm-6 clearfix text-right">
                        <div class="d-md-inline-block d-block mr-md-4">
                          <!-- Hide Notification First -->
                            <ul class="notification-area" hidden>
                                <li class="dropdown">
                                    <i class="ti-bell dropdown-toggle" data-toggle="dropdown">
                                        <span></span>
                                    </i>
                                    <div class="dropdown-menu bell-notify-box notify-box">
                                        <span class="notify-title">Notifications <a href="#">view all</a></span>
                                        <div class="nofity-list">
                                            <a href="#" class="notify-item">
                                                
                                                <div class="notify-text">
                                                    <p>You have Changed Your Password</p>
                                                    <span>8/03/2021</span>
                                                </div>
                                            </a>
                                            <a href="#" class="notify-item">
                                                
                                                <div class="notify-text">
                                                    <p>New Commetns On Post</p>
                                                    <span>7/29/2021</span>
                                                </div>
                                            </a>
                                            <a href="#" class="notify-item">
                                                
                                                <div class="notify-text">
                                                    <p>Some special like you</p>
                                                    <span>7/25/2021</span>
                                                </div>
                                            </a>
                                            <a href="#" class="notify-item">
                                                
                                                <div class="notify-text">
                                                    <p>New Commetns On Post</p>
                                                    <span>7/24/2021</span>
                                                </div>
                                            </a>
                                            <a href="#" class="notify-item">
                                                
                                                <div class="notify-text">
                                                    <p>Some special like you</p>
                                                    <span>7/20/2021</span>
                                                </div>
                                            </a>
                                        </div>
                                    </div>
                                </li>
                            </ul>
                          <!-- Hide Notification -->
                        </div>
                        <div class="clearfix d-md-inline-block d-block">
                            <div class="user-profile m-0 p-2" style="background:none;">
                                <img class="avatar user-thumb" src="assets/images/author/avatar.png" alt="avatar" style="border:1px solid black;padding:3px">
                                <h4 class="user-name dropdown-toggle" data-toggle="dropdown" style="color:black"> <span id="display-name"></span> <i class="fa fa-angle-down"></i></h4>
                                <div class="dropdown-menu">

                                <a class="dropdown-item pt-2" href="profile-settings.html" style="font-size:16px;">Profile Settings</a>
                                <hr>
                                <a class="dropdown-item" href="../../login.html" style="font-size:16px;">Log Out</a>
                            </div>
                            </div>
                        </div>
                    </div>
                   
                   
                </div>
            </div>
            <!-- header area end -->
                       <!-- page title area start -->
            <div class="page-title-area">
                <div class="row align-items-center">
                    <div class="col-sm-6">
                        <div class="breadcrumbs-area clearfix">
                            <h4 class="page-title pull-left">View Store Informations</h4>
                            <ul class="breadcrumbs pull-left">
                                <li><a href="dashboard.html">Home</a></li>
                                <li><a href="view_stores.html">Stores</a></li>
                                <li><span>Informations</span></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-sm-6 clearfix" style="height:60px;">
                       
                    </div>
                </div>
            </div>            
            <div class="main-content-inner">
                <div class="row">
                    <!-- Progress Table start -->
                    <div class="col-12 mt-5">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title" style="text-transform: none;">List of Informations For This Store</h4>
                                <a href="view_stores.html" class="btn btn-danger btn-sm">Return</a>
                                <div class="single-table">
                                    <div class="table-responsive">
                                        <table id="show-products-table" class="table table-hover progress-table text-left">
                                            <thead class="text-uppercase">
                                                <tr>
                                                    <th scope="col">Products Name</th>
                                                    <th scope="col">Products Price</th>
                                                    <th scope="col">Products Category</th>
                                                    <th scope="col">Products Status</th>
                                                </tr>
                                            </thead>
                                            <tbody>


                                                
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Progress Table end -->
                </div>
            </div>
        </div>
        <!-- main content area end -->

         <!-- footer area start-->
        <footer style="display:none">
           <!--  <div class="footer-area">
                <p>Â© Copyright 2018. All right reserved. Template by <a href="https://colorlib.com/wp/">Colorlib</a>.</p>
            </div> -->
        </footer>
        <!-- footer area end-->

    </div>
    <!-- jquery latest version -->
    <script src="assets/js/vendor/jquery-2.2.4.min.js"></script>
    <!-- bootstrap 4 js -->
    <script src="assets/js/popper.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/owl.carousel.min.js"></script>
    <script src="assets/js/metisMenu.min.js"></script>
    <script src="assets/js/jquery.slimscroll.min.js"></script>
    <script src="assets/js/jquery.slicknav.min.js"></script>

    <!-- others plugins -->
    <script src="assets/js/plugins.js"></script>
    <script src="assets/js/scripts.js"></script>

    <!-- firebase test -->

      <!-- firebase test -->
    <script src="https://www.gstatic.com/firebasejs/8.8.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.8.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.8.1/firebase-auth.js"></script>
     <script>
        var firebaseConfig = {
          apiKey: "AIzaSyCoOjba1Ej7CJzg_sNXdfMUhQwqbV5Cruo",
          authDomain: "drinktubig-bcaf5.firebaseapp.com",
          projectId: "drinktubig-bcaf5",
          storageBucket: "drinktubig-bcaf5.appspot.com",
          messagingSenderId: "865738659083",
          appId: "1:865738659083:web:60d90ffd1add62930a3e0e",
          measurementId: "G-8ETGGW6B5L"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
    </script>

   
    <script>
        function accessDenied() {
            location.href = "access-denied.html";
        }
    </script>

     <script>
     $( document ).ready(function() {
         firebase.auth().onAuthStateChanged((user) => {
              if (user) {
                // User is signed in, see docs for a list of available properties
                // https://firebase.google.com/docs/reference/js/firebase.User
                var uid = user.uid;
                var user = user;
           
                $('#display-name').html(user.displayName);
                  
                 } else {
                    //accessDenied();
                 }
               });
             });
     </script>

    <script>
        function signOut() {
          //var user = firebase.auth().currentUser;
          firebase.auth().signOut().then(function() {
            console.log('Signed Out');
            location.href = "../../login.html";
          }, function(error) {
            console.error('Sign Out Error', error);
          });
        }
    </script>

  
<script>
        
        var getUrlParameter = function getUrlParameter(sParam) {
        var sPageURL = window.location.search.substring(1),
        sURLVariables = sPageURL.split('&'),
        sParameterName,
        i;

    for (i = 0; i < sURLVariables.length; i++) {
        sParameterName = sURLVariables[i].split('=');

        if (sParameterName[0] === sParam) {
            return typeof sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
        }
    }
    return false;
};
    
    var show_id = getUrlParameter('id');

    let filterProductsRef = db.collection('ProductList');
    let deleteIDs = [];

    // REAL TIME LISTENER
        filterProductsRef.onSnapshot(snapshot => {
            let changes = snapshot.docChanges();
            changes.forEach(change => {
                if (change.type == 'added') {
                    console.log('added');
                } else if (change.type == 'modified') {
                    console.log('modified');
                } else if (change.type == 'removed') {
                    $('tr[data-id=' + change.doc.id + ']').remove();
                    console.log('removed');
                }
            });
        });


    const displayFilterProducts = async (doc) => {

    let filterProducts = filterProductsRef;

    let filterProductsStoreID = filterProducts.where("Store_ID", "==", show_id);


    // .startAfter(doc || 0).limit(10000)
    const data = await filterProductsStoreID.get();
   
    data.docs.forEach(doc => {
        const filterStore = doc.data();
        var product_status = filterStore.Product_Status;

        // display user status
                if(product_status == 'Available') {
                    var display = '<span class="status-p bg-success text-center">Available</span>';
                  
                } else if(product_status == 'Not Available') {
                    var display = '<span class="status-p bg-danger text-center">Not Available</span>';
                 }

        // display verification status

        let item =
            `<tr data-id="${doc.id}">  
                    <td class="product_name">${filterStore.Product_Name}</td>
                    <td class="product_price">${filterStore.Product_Price}</td>
                    <td class="product_category">${filterStore.Product_Category}</td>
                    <td>${display}</
            </tr>`;

     

         $('#show-products-table').append(item);
     
    });

    // UPDATE LATEST DOC
    latestDoc = data.docs[data.docs.length - 1];

}

$(document).ready(function () {
    let latestDoc = null;

    // LOAD INITIAL DATA
    displayFilterProducts();

    // LOAD MORE
    $(document).on('click', '.js-loadmore', function () {
        displayFilterProducts(latestDoc);
    });
  });

</script>


</body>
</html>
